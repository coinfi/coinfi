<script src="/js/gauge.min.js"></script>
<link rel="stylesheet" href="/css/gauge.css" style="display: none;"></link>
<style>
  .gauge {
    margin: 50px 50px -150px 50px;
  }
  .gauge:before {
    background-color: #000;
  }
  .gauge-value {
    white-space: nowrap;
  }
  .gauge-values .gauge-value:nth-child(1) {
    transform: rotate(-70deg) translate(-5px, -5px);
  }
  .gauge-values .gauge-value:nth-child(2) {
    transform: rotate(-35deg) translate(-2px, -5px);
  }
  .gauge-values .gauge-value:nth-child(3) {
    transform: translate(0px, -5px);
  }
  .gauge-values .gauge-value:nth-child(4) {
    transform: rotate(35deg) translate(2px, -5px);
  }
  .gauge-values .gauge-value:nth-child(5) {
    transform: rotate(70deg) translate(5px, -5px);
  }
  .gauge-arrow {
    filter: brightness(0);
  }
  .indicator-signal.buy {
    color: green;
  }
  .indicator-signal.sell {
    color: red;
  }
</style>
<table>
  <tr>
    <th></th>
    <th><%= t :sample_value_label %></th>
    <th><%= t :min_label %></th>
    <th><%= t :max_label %></th>
    <th><%= t :signal_label %></th>
    <th><%= t :rule_label %></th>
  </tr>
  <% @indicator_rows.each do |indicator| %>
    <tr>
      <td><%= t(indicator[:symbol], scope: 'indicators.title') %></td>
      <td><%= indicator[:value] %></td>
      <td><%= indicator[:min].presence || t(:na) %></td>
      <td><%= indicator[:max].presence || t(:na) %></td>
      <td class="indicator-signal <%= indicator[:signal].downcase %>">
        <%= indicator[:signal].present? ? t(indicator[:signal].downcase).upcase : "" %>
      </td>
      <td><%= t(indicator[:symbol], scope: 'indicators.rule') %></td>
    </tr>
  <% end %>
</table>
<div class="gauge-wrapper">
  <div class="gauge"></div>
</div>
<div class="summary">
  <div>
    <div><%= @summary[:sell] %></div>
    <div><%= t(:sell).upcase %></div>
  </div>
  <div>
    <div><%= @summary[:neutral] %></div>
    <div><%= t(:neutral).upcase %></div>
  </div>
  <div>
    <div><%= @summary[:buy] %></div>
    <div><%= t(:buy).upcase %></div>
  </div>
</div>
<div><%= t(:updated_on_date, date: l(@last_updated, format: :readable_date)) %></div>
<div class="stats">
  <div>
    <div><%= t(:day_move_label, days: 1) %></div>
    <div><%= format_percentage(@coin.change24h) %></div>
  </div>
  <div>
    <div><%= t(:day_move_label, days: 7) %></div>
    <div><%= format_percentage(@coin.change7d) %></div>
  </div>
  <div>
    <div><%= t(:day_move_label, days: 30) %></div>
    <div><%= format_percentage(@coin.change30d) %></div>
  </div>
  <div>
    <div><%= t :market_cap_label %></div>
    <div><%= format_price(@coin.market_cap / 1000000, precision: 2) %></div>
  </div>
  <div>
    <div><%= t :volume_24h_label %></div>
    <div><%= format_price(@coin.volume24h / 1000) %></div>
  </div>
  <div>
    <div><%= t :circulating_supply_label %></div>
    <div><%= @coin.available_supply > 0 ? format_price(@coin.available_supply) : "N/A"  %></div>
  </div>
  <div>
    <div><%= t :fixed_supply_label %></div>
    <div><%= @coin.max_supply > 0 ? format_price(@coin.max_supply) : "N/A" %></div>
  </div>
</div>
<% unless @news_items.blank? %>
<div class="news">
  <h2 class="news__title"><%= t :market_news_research %></h2>
  <% @news_items.each do |news_item| %>
  <div class="news-item">
    <h4 class="news_item__title">
      <%= news_item.title %>
    </h4>
    <div class="news_item__summary">
      <%= news_item.short_summary %>
    </div>
    <div class="news_item__link">
      <%= link_to t(:read_more), news_item_url(id: news_item.id, slug: news_item.slug) %>
    </div>
  </div>
  <% end %>
</div>
<% end %>
<script type="text/javascript">
  var options = {
    angle: [180, 360],
    values: {
      10: '<%= t(:strong_sell).titleize %>',
      30: '<%= t(:sell).titleize %>',
      50: '<%= t(:neutral).titleize %>',
      70: '<%= t(:buy).titleize %>',
      90: '<%= t(:strong_buy).titleize %>'
    },
    colors: {
      0: '#2f1b1b',
      20: '#7a4d4d',
      40: '#768d9f',
      60: '#4d627a',
      80: '#273249'
    },
    marks: [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100],
    value: <%= @summary_value %>
  };
  var gauge = new Gauge(document.querySelector(".gauge"), options);
</script>